<!-- add connector  -->
<div class="page">

  <h2 *ngIf="station">{{ station.name }}</h2>
  <h3 *ngIf="station">{{ station.address }}</h3>

  <!-- ADD CHARGE POINT -->
  <button class="add-btn" (click)="openAddChargePointModal()">
    Add Charge Point
  </button>

  <div *ngIf="loading" class="loading">Loading charging points...</div>
  <div *ngIf="error" class="error">{{ error }}</div>

  <div *ngIf="!loading && chargePoints.length === 0">
    No charging points found
  </div>

  <div class="cp-list">
    <div class="cp-card" *ngFor="let cp of chargePoints">

      <!-- CHARGE POINT HEADER -->
      <div class="cp-header" (click)="toggleConnectors(cp)">
        <div class="cp-info">
          <h4>{{ cp.id }}</h4>
          <p><b>Vendor:</b> {{ cp.vendor }}</p>
          <p><b>Model:</b> {{ cp.model }}</p>
          <p><b>Serial:</b> {{ cp.serialNumber }}</p>
          <p><b>Max Power:</b> {{ cp.maxPowerKw }} kW</p>
          <p><b>Voltage:</b> {{ cp.voltage }} V</p>
        </div>

        <button class="toggle-btn">
          {{ cp.expanded ? 'Hide Connectors' : 'Show Connectors' }}
        </button>
      </div>

      <!-- CONNECTORS -->
      <div class="connectors" *ngIf="cp.expanded">

        <!-- ADD CONNECTOR -->
        <button class="add-connector-btn" (click)="openAddConnectorModal(cp.id)">
          Add Connector
        </button>

        <div *ngIf="cp.connectors.length === 0">
          No connectors found
        </div>

        <div class="connector" *ngFor="let c of cp.connectors">
          <p><b>Connector ID:</b> {{ c.connectorId }}</p>
          <p><b>Type:</b> {{ c.type }}</p>
          <p><b>Power:</b> {{ c.powerRating }} kW</p>
        </div>

      </div>
    </div>
  </div>
</div>

<!-- ================= ADD CHARGE POINT MODAL ================= -->

<div class="modal-overlay" *ngIf="showAddChargePointModal">
  <div class="modal-popup">

    <h3>Add Charge Point</h3>

    <label>
      Charge Point ID
      <input type="text" [(ngModel)]="newChargePoint.id" />
    </label>

    <label>
      Vendor
      <input type="text" [(ngModel)]="newChargePoint.vendor" />
    </label>

    <label>
      Model
      <input type="text" [(ngModel)]="newChargePoint.model" />
    </label>

    <label>
      Serial Number
      <input type="text" [(ngModel)]="newChargePoint.serialNumber" />
    </label>

    <label>
      Max Power (kW)
      <input type="number" [(ngModel)]="newChargePoint.maxPowerKw" />
    </label>

    <label>
      Voltage
      <input type="number" [(ngModel)]="newChargePoint.voltage" />
    </label>

    <div class="modal-actions">
      <button (click)="addChargePoint()">Add</button>
      <button class="cancel" (click)="closeAddChargePointModal()">Cancel</button>
    </div>

  </div>
</div>

<!-- ================= ADD CONNECTOR MODAL ================= -->

<div class="modal-overlay" *ngIf="showAddConnectorModal">
  <div class="modal-popup">

    <h3>Add Connector</h3>

    <label>
      Connector ID
      <input type="number" [(ngModel)]="newConnector.connectorId" />
    </label>

    <label>
      Type
      <input type="text" [(ngModel)]="newConnector.type" />
    </label>

    <label>
      Power Rating (kW)
      <input type="number" [(ngModel)]="newConnector.powerRating" />
    </label>

    <div class="modal-actions">
      <button (click)="addConnector()">Add</button>
      <button class="cancel" (click)="closeAddConnectorModal()">Cancel</button>
    </div>

  </div>
</div>